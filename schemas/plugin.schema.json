{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Dotfiles Plugin Schema",
  "type": "object",
  "required": ["name", "version", "description", "api_version", "platforms"],
  "properties": {
    "name": {
      "type": "string",
      "pattern": "^[a-z0-9-_]+$",
      "description": "Plugin name (lowercase, alphanumeric, hyphens, underscores)"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9-]+)?$",
      "description": "Semantic version (e.g., 1.0.0, 1.0.0-beta)"
    },
    "description": {
      "type": "string",
      "minLength": 10,
      "description": "Plugin description"
    },
    "api_version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Plugin API version"
    },
    "author": {
      "type": "object",
      "properties": {
        "name": {"type": "string"},
        "email": {"type": "string", "format": "email"},
        "url": {"type": "string", "format": "uri"}
      },
      "required": ["name"]
    },
    "license": {
      "type": "string",
      "description": "Plugin license (e.g., MIT, GPL-3.0)"
    },
    "homepage": {
      "type": "string",
      "format": "uri",
      "description": "Plugin homepage URL"
    },
    "repository": {
      "type": "string",
      "format": "uri",
      "description": "Plugin repository URL"
    },
    "platforms": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": ["all", "macos", "ubuntu", "wsl", "amazon-linux"]
      },
      "minItems": 1,
      "description": "Supported platforms"
    },
    "categories": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": ["shell", "editor", "vcs", "development", "productivity", "system", "security", "other"]
      },
      "description": "Plugin categories"
    },
    "dependencies": {
      "type": "object",
      "properties": {
        "modules": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Required dotfiles modules"
        },
        "plugins": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Required plugins"
        },
        "system": {
          "type": "object",
          "patternProperties": {
            "^(all|macos|ubuntu|wsl|amazon-linux)$": {
              "type": "array",
              "items": {"type": "string"}
            }
          },
          "description": "System package dependencies by platform"
        }
      }
    },
    "conflicts": {
      "type": "array",
      "items": {"type": "string"},
      "description": "Conflicting plugins or modules"
    },
    "hooks": {
      "type": "object",
      "properties": {
        "pre_install": {"type": "string"},
        "post_install": {"type": "string"},
        "pre_uninstall": {"type": "string"},
        "post_uninstall": {"type": "string"},
        "pre_update": {"type": "string"},
        "post_update": {"type": "string"}
      },
      "description": "Plugin lifecycle hooks"
    },
    "configuration": {
      "type": "object",
      "properties": {
        "priority": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "default": 50,
          "description": "Installation priority (0-100)"
        },
        "interactive": {
          "type": "boolean",
          "default": false,
          "description": "Requires user interaction during installation"
        }
      }
    },
    "files": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["source", "target"],
        "properties": {
          "source": {"type": "string"},
          "target": {"type": "string"},
          "template": {"type": "boolean", "default": false},
          "executable": {"type": "boolean", "default": false},
          "backup": {"type": "boolean", "default": true},
          "platforms": {
            "type": "array",
            "items": {"type": "string"}
          }
        }
      },
      "description": "Files to install"
    }
  }
}